[{"start":{"activity_category":1,"activity":{"cell_id":"24434bda-7929-444f-b4dd-5c7bb4fa643a","code":8,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"script_id":"391ea882-6268-4c88-b9b9-69f5e3892605","password":null,"iterator_source":{"use_previous_step":false},"studio_version":{"created":"8.5.8","updated":"8.5.8"},"paper_size":{"height":2000,"width":2000,"x":-55,"y":-50},"username":null,"link_vertices":{"0":{"source_id":"ff7c4935-1fc6-452d-bd60-4447befeae3f","source_port":"exit","target_id":"50074064-fa27-4173-85cf-2fb2dc7d182a","vertices":[{"x":-23,"y":1202}]},"1":{"source_id":"ff7c4935-1fc6-452d-bd60-4447befeae3f","source_port":"exit","target_id":"50074064-fa27-4173-85cf-2fb2dc7d182a","vertices":[{"x":-23,"y":1202}]}},"project":{"name":"testEmail","path":"C:\\Users\\Jorge Noguera\\Documents\\Tickets\\testEmail","main":"main.neek","settings":{"variables":[],"performanceSettings":{"automaticallyCreateLogForEachRun":true,"isStatusWindowEnabled":true},"browserSettings":{"useDefaultProfile":true,"useBrowser":"native_chrome","customArgs":"","keepBrowserOpen":true},"doNotCloseWhileDebug":false,"microsoftExcelActivities":"native"}}}},"position":{"x":422.5,"y":0},"next":{"exit":{"activity_category":7,"activity":{"cell_id":"a2c3e97e-b34e-433a-9494-c466fc6fa07d","code":2,"params":{"version":"4.35.0","to":{"use_previous_step":false},"cc":{"use_previous_step":false},"subject":{"use_previous_step":false},"body":{"use_previous_step":false},"date_from":{"use_previous_step":false,"statement":"moment().subtract(10, 'days')"},"attachment_path":{"use_previous_step":false},"attachment_save_template":{"value":"Tmp","use_previous_step":false},"attachment_save":true,"attachment_save_duplicate":true,"server_host":{"use_previous_step":false},"server_secure":true,"server_type":"gmail","comment":"Tmp es una carpeta temporal para guardar los archivos","breakpoint":false,"box_name":{"value":"","use_previous_step":false},"login":{"host":"GoogleMail","login":"j.noguera@electroneek.com"},"subject_contains":{"value":"","use_previous_step":false},"body_contains":{"value":"","use_previous_step":false},"sender":{"value":"","use_previous_step":false},"attachment_filter":"all","mark_as_read":true,"emails_limit":{"value":"","use_previous_step":false},"move_folder":{"use_previous_step":false}}},"position":{"x":312.5,"y":110},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"c949bf20-6c37-4008-a0cf-4e082ebbeeaa","code":3,"params":{"version":"8.5.8","variable_name":"email_messages","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":312.5,"y":221.2},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"6ad74661-2d29-44b2-bed0-d16459e61427","code":3,"params":{"version":"4.35.0","variable_name":"rootFolder","variable_value":{"use_previous_step":false,"statement":"\"C:\\\\tmp\\\\\""},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"Esta es la carpeta raiz final para guardar los archivos","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":312.5,"y":319.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"7fa25851-dbf5-44ed-b22f-096c4fc845b9","code":3,"params":{"version":"4.35.0","variable_name":"sanitzeEmails","variable_value":{"use_previous_step":false,"statement":"sanitizeEmails(email_messages);\r\n\r\nfunction sanitizeEmails(emails){    \r\n    for (var i=0; i < emails.length; i++) {\r\n        if (emails[i].hasAttachment == true){\r\n            emails[i].date = moment(emails[i].date).format(\"DD-MM-YYYY\");\r\n            emails[i].subject = emails[i].subject.replace(/[^a-zA-Z0-9_ -]/g,'').trim();\r\n            if(emails[i].subject.length>50){\r\n                emails[i].subject = emails[i].subject.slice(0,100);\r\n                }\r\n        }\r\n    }\r\n    email_messages = email_messages;   \r\n}"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"comment":"Sanitizar asunto y formato de fecha","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":312.5,"y":430.8},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"af71537f-605a-42ed-bf14-57dae4e1ace3","code":3,"params":{"version":"8.5.8","variable_name":"i","variable_value":{"value":0,"use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":391.5,"y":580.4},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"82d8f06d-b923-4771-a099-9909e04c057c","code":1,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"condition":"i<email_messages.length","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":312.5,"y":666},"next":{"yes":{"activity_category":1,"activity":{"cell_id":"9d5f06f9-4cf7-486a-8739-c1530c792565","code":1,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"email_messages[i].hasAttachment == true","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":97,"y":764.4},"next":{"yes":{"activity_category":2,"activity":{"cell_id":"96d74a62-cab1-43f9-8ffc-b3d483d7b2ec","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"rootFolder"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"emails[i].date+\"\\\\\"+emails[i].subject"},"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":73,"y":879},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"f0c5c3a6-344e-4121-aed5-26980c5bd0e6","code":3,"params":{"version":"8.5.8","variable_name":"j","variable_value":{"use_previous_step":false,"statement":"0"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":176,"y":961.2},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"50074064-fa27-4173-85cf-2fb2dc7d182a","code":1,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"condition":"j<email_messages[i].attachments.length","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":0,"y":1058},"next":{"yes":{"activity_category":2,"activity":{"cell_id":"20d0a62c-979e-404c-b0e9-960d5f2bdfc8","code":5,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"email_messages[i].attachments[j].path"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false},"breakpoint":false,"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":33.7,"y":1158.0000000000002},"next":{"yes":{"activity_category":2,"activity":{"cell_id":"9df5cd3e-5c6b-4cf7-91d3-ba4d71f22e0e","code":7,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"email_messages[i].attachments[j].path"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"extractFileName(email_messages[i].attachments[j].path);\r\n\r\nfunction extractFileName(ruta){\r\n    var ruta = ruta.split('Tmp\\\\');\r\n    ruta = rootFolder+emails[i].date+\"\\\\\"+emails[i].subject+\"\\\\\"+ruta[1];\r\n    ruta = ruta.trim();\r\n    return ruta;\r\n}"},"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":0,"y":1243.6000000000001},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"ff7c4935-1fc6-452d-bd60-4447befeae3f","code":3,"params":{"version":"8.5.8","variable_name":"j","variable_value":{"use_previous_step":false,"statement":"j=j+1"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":107.5,"y":1329.2},"next":{"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","yes","next","exit","next","exit"]}}}}},"no":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","yes","next","exit","next","exit","next","yes","next","yes","next","exit"]}}},"no":{"activity_category":1,"activity":{"cell_id":"c4006fe3-f983-4722-a80b-4763c3877f07","code":3,"params":{"version":"8.5.8","variable_name":"i","variable_value":{"use_previous_step":false,"statement":"i=i+1"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":391.5,"y":1158.0000000000002},"next":{"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit"]}}}}}}}}},"no":{"activity_category":1,"activity":{"cell_id":"304ffd35-4131-4e54-b17f-c7baf4ea449d","code":14,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"value":"","use_previous_step":false},"log_message":{"use_previous_step":false,"statement":"\"NO - - \"+email_messages[i]"},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":284,"y":864},"next":{}}}},"no":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","yes","next","exit","next","exit","next","no"]}}}}}}}}}}}}}}}}]