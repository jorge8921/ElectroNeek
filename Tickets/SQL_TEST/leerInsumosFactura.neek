[{"start":{"activity_category":1,"activity":{"cell_id":"5f2b33df-d3b0-403b-ab95-1809083d89b7","code":8,"params":{"version":"4.0.0","variable_value":{"use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"script_id":"94a8131d-2b0c-478a-a003-8d3fac1c5226","app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"studio_version":{"created":"9.1.4","updated":"9.2.12"},"paper_size":{"height":3553,"width":2000,"x":-134,"y":-697},"js_file_path":null,"username":null,"timeout":0,"link_vertices":{"0":{"source_id":"192866c5-2a9c-412a-8b56-726ebf124d20","source_port":"exit","target_id":"25cb5967-e8a5-4761-925c-79db993b0a36","vertices":[{"x":124,"y":2507}]},"1":{"source_id":"cf6032f9-3910-4ae1-9efd-75ddded1e94b","source_port":"exit","target_id":"6197d592-8852-45ee-a9bc-9f5c2517ea6f","vertices":[{"x":1361,"y":2152}]}},"project":{"name":"SQL_TEST","path":"C:\\Users\\Jorge Noguera\\Documents\\GitHub\\ElectroNeek\\Tickets\\SQL_TEST","main":"leerInsumosFactura.neek","settings":{"variables":[],"performanceSettings":{"automaticallyCreateLogForEachRun":false,"isStatusWindowEnabled":"full"},"browserSettings":{"useDefaultProfile":true,"useBrowser":"native_chrome","customArgs":"","keepBrowserOpen":true},"doNotCloseWhileDebug":false,"microsoftExcelActivities":"native","antiCaptcha":true}}}},"position":{"x":172,"y":-642},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"d28e4673-deea-4559-8d44-cb6575b87f44","code":3,"params":{"version":"4.35.0","variable_name":"globalBoolEjecucionCorrecta","variable_value":{"use_previous_step":false,"statement":"false"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":73,"y":-537},"next":{"exit":{"activity_category":17,"activity":{"cell_id":"963d30e9-de17-4fa3-a6b3-fc53f4727058","code":1,"params":{"version":"4.35.0","database_type":"mssql","setup_method":"basicParameters","connection_string":{"use_previous_step":false,"statement":"`mssql://apl-rpades-srvgprpades:Grupo#Papelesa.2023.` +`@SRVGPRPADES`+`?database=`+ `REGIMEN21`+`&request%20timeout=25000`"},"host":"10.200.2.17","port":1433,"database":"REGIMEN21","user":"","password":"","query_text":{"use_previous_step":false},"comment":"`mssql://COABOY4:123456` +`@COABOY`+`?database=`+ `REGIMEN_21`+`&request%20timeout=25000`SRVGPRPADES\\SQLEXPRESS","breakpoint":false,"deactivated":false,"login":{"host":"MSSQL","login":"jorge"},"encrypt":false}},"position":{"x":48,"y":-422},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"6cdc082f-f5ac-45fa-ba29-c49a1e316acb","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"'C:\\\\GAIA\\\\REGIMEN 21\\\\RESULTADOS\\\\'"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"\"\""},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":false}},"position":{"x":110,"y":-268},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"6d555b3f-3f4c-4783-9af3-8c361820d6a4","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"'C:\\\\GAIA\\\\INSUMOS-COMPARTIDOS\\\\INSUMOS\\\\'"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"\"\""},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":false}},"position":{"x":89,"y":-172},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"b8be5593-8442-44d5-9c6d-12260202016d","code":2,"params":{"version":"4.35.0","path":{"value":"C:\\GAIA\\INSUMOS-COMPARTIDOS\\INSUMOS\\ARCHIVO DE FACTURAS SUBPARTIDA.xlsx","use_previous_step":false},"content":{"use_previous_step":false},"copy_from":{"value":"ARCHIVO DE FACTURAS SUBPARTIDA.xlsx","use_previous_step":false},"move_to":{"use_previous_step":false},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":true}},"position":{"x":129,"y":-78},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"29bf0858-4368-47f9-a018-fb534c9a103d","code":3,"params":{"version":"4.35.0","variable_name":"configRutaRaizResultados","variable_value":{"use_previous_step":false,"statement":"'C:\\\\GAIA\\\\REGIMEN 21\\\\RESULTADOS\\\\'"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":122,"y":24.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"61497254-4336-4205-9e4f-1922ae1f81b1","code":3,"params":{"version":"4.35.0","variable_name":"configRutaInsumosCompartidos","variable_value":{"use_previous_step":false,"statement":"'C:\\\\GAIA\\\\INSUMOS-COMPARTIDOS\\\\INSUMOS\\\\'"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":99,"y":128.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"28b450ca-5cd1-4380-83b6-00f5b156933e","code":3,"params":{"version":"4.35.0","variable_name":"contadorIntentos","variable_value":{"value":0,"use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":214,"y":245.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"be25db5c-6812-4bca-be6d-066f46706e14","code":3,"params":{"version":"4.35.0","variable_name":"mensajeError","variable_value":{"value":"","use_previous_step":false},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":251,"y":332.6},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"e0258e73-333c-4ffa-84ba-b3377eeac27b","code":10,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"configRutaInsumosCompartidos"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":false}},"position":{"x":213,"y":424.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"a4828a2c-06bc-44d3-ae39-2565bee5f55e","code":3,"params":{"version":"9.1.4","variable_name":"directory_files","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":214,"y":526.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"ae307e18-2efb-447e-ab36-2d5680f2e47a","code":3,"params":{"version":"4.35.0","variable_name":"listaArchivosFactura","variable_value":{"use_previous_step":false,"statement":"directory_files.filter(e=>e.includes(\"ARCHIVO DE FACTURAS SUBPARTIDA\")&&!e.includes(\"~$\"))"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":171,"y":633.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"007e037c-e75a-4f6e-b8c5-a5c1307b74d9","code":3,"params":{"version":"4.35.0","variable_name":"contadorArchivosFactura","variable_value":{"value":0,"use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":189,"y":762.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"4a014e89-6cd6-4848-9637-d453c1218d33","code":3,"params":{"version":"4.35.0","variable_name":"cantidadArchivosFactura","variable_value":{"use_previous_step":false,"statement":"listaArchivosFactura.length"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":220,"y":849.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"6197d592-8852-45ee-a9bc-9f5c2517ea6f","code":1,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"cantidadArchivosFactura>contadorArchivosFactura","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":261,"y":960.6},"next":{"yes":{"activity_category":1,"activity":{"cell_id":"1510919f-ebe0-4aeb-bbbc-f737d7a524aa","code":3,"params":{"version":"4.35.0","variable_name":"archivoFacturas","variable_value":{"use_previous_step":false,"statement":"listaArchivosFactura[contadorArchivosFactura]"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":174,"y":1086.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"6deb4ad3-a19e-48d5-aab3-d142ff394b53","code":3,"params":{"version":"4.35.0","variable_name":"subpartidaTrabajo","variable_value":{"use_previous_step":false,"statement":"archivoFacturas.split('SUBPARTIDA')[1].split('.')[0].trim()"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":168,"y":1211.6},"next":{"exit":{"activity_category":17,"activity":{"cell_id":"1ecf444c-fbed-4a5e-a7c6-2b3bed9c080e","code":2,"params":{"version":"4.35.0","database_type":null,"setup_method":"basicParameters","connection_string":{"use_previous_step":false},"host":null,"port":null,"database":null,"user":"","password":"","query_text":{"use_previous_step":false,"statement":"`EXEC [REG21].[INGRESAR_ARCHIVO_FACTURAS] @rutaExcel ='${configRutaInsumosCompartidos+archivoFacturas}',\r\n@subPartida='${subpartidaTrabajo}'`"},"comment":null,"breakpoint":false,"deactivated":false,"login":null,"encrypt":false}},"position":{"x":145,"y":1316.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"60b18a37-515b-45ea-88f1-bf517424d8c0","code":3,"params":{"version":"4.35.0","variable_name":"resultadoQuery","variable_value":{"use_previous_step":true},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":66,"y":1434.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"02486e30-964a-4698-ab7c-d645d79471c7","code":1,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"resultadoQuery[0].idArchivoExcel","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":94,"y":1528.6},"next":{"yes":{"activity_category":1,"activity":{"cell_id":"f7db9dbb-56bd-4af2-86a3-c64ac08c1f13","code":3,"params":{"version":"4.35.0","variable_name":"idArchivoExcel","variable_value":{"use_previous_step":false,"statement":"resultadoQuery[0].idArchivoExcel"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":153,"y":1652.6},"next":{"exit":{"activity_category":6,"activity":{"cell_id":"5b7c0627-b6cc-4a28-b487-cb25177fc593","code":1,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"configRutaInsumosCompartidos+archivoFacturas"},"json_value":{"use_previous_step":false},"sheet_name":{"value":"","use_previous_step":false},"row":{"use_previous_step":false},"column_map":{"use_previous_step":false},"dest_path":{"use_previous_step":false},"dest_sheet_name":{"use_previous_step":false},"headers_format":1,"comment":null,"breakpoint":false,"deactivated":false,"from_row":{"use_previous_step":false},"to_row":{"use_previous_step":false},"from_column":{"use_previous_step":false},"to_column":{"use_previous_step":false},"range":{"use_previous_step":false},"cell_value":{"use_previous_step":false},"macros_path":{"use_previous_step":false},"macros_function_name":{"use_previous_step":false},"macros_param":{"use_previous_step":false},"insert_or_delete":"insert","column_count":{"use_previous_step":false},"sort_range":{"use_previous_step":false},"sort_columns":{"use_previous_step":false},"sort_direction":0}},"position":{"x":289,"y":1754.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"2031bbb0-f2cd-4497-beaf-7876017428dd","code":3,"params":{"version":"9.1.4","variable_name":"contenidoArchivoExcelFacturas","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":289,"y":1848.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"604d7490-b190-4601-a8f1-42b9b3abe171","code":3,"params":{"version":"9.1.4","variable_name":"contenidoArchivoExcelFacturas","variable_value":{"use_previous_step":false,"statement":"contenidoArchivoExcelFacturas[ Object.keys(contenidoArchivoExcelFacturas)[0]]"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"app_title":null,"launch_params":null,"password":null,"iterator_source":{"use_previous_step":false},"js_file_path":null,"username":null,"timeout":0}},"position":{"x":357,"y":1965},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"4d309e79-e393-46b6-95da-8713beb12fce","code":12,"params":{"version":"4.35.0","variable_name":"$previous_result$","variable_value":{"use_previous_step":false,"statement":"contenidoArchivoExcelFacturas=contenidoArchivoExcelFacturas.map(e=>{return {\r\nAC:e[\"AC\"]==undefined ? \"\" : e[\"AC\"],\r\nnumeroCesion:e[\"# Cesion Titularidad\"]==undefined? \"\" :e[\"# Cesion Titularidad\"],\r\nfacturaSRI:e[\"Factura SRI\"]==undefined?\"\":e[\"Factura SRI\"],\r\nfechaFactura:e[\"FechaFact.\"]==undefined?\"\":e[\"FechaFact.\"],\r\ncliente:e[\"Cliente:\"]==undefined?\"\":e[\"Cliente:\"],\r\ntextoBreveMaterial:e[\"Texto breve de material\"]==undefined?\"\":e[\"Texto breve de material\"],\r\ncdtaFacturada:e[\"Ctd.fact.\"]==undefined?\"\":e[\"Ctd.fact.\"],\r\nnotaCreditoDevolucion:e[\"N/C Devol.\"]==undefined?\"\":e[\"N/C Devol.\"],\r\nfechaNotaCredito:e[\"Fecha  NC \"]==undefined?\"\":e[\"Fecha  NC \"],\r\ncodigoInscrLkBco:e[\"C. INS-Lk BCO\"]==undefined?\"\":e[\"C. INS-Lk BCO\"],\r\npartidaArancelaria:e[\"P. Aranc.\"]==undefined?\"\":e[\"P. Aranc.\"],\r\ndescripcionItem:e[\"DESCRIP.\"]==undefined?\"\":e[\"DESCRIP.\"],\r\ntipoUnidad:e[\"TIPO UND\"]==undefined?\"\":e[\"TIPO UND\"],\r\nmaxCnLiBco:e[\"M치x. de CN LI BCO\"]==undefined?\"\":e[\"M치x. de CN LI BCO\"],\r\nmaxCdLiBco:e[\"M치x. de CD LI BCO\"]==undefined?\"\":e[\"M치x. de CD LI BCO\"]\r\n}});"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":"leerInsumosFactura_1.js","username":null,"timeout":0}},"position":{"x":393,"y":2081.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"a706f5d7-0e52-4d3e-8679-15e3ed969834","code":3,"params":{"version":"4.35.0","variable_name":"query","variable_value":{"use_previous_step":false,"statement":"crearQuery(contenidoArchivoExcelFacturas)\r\n\r\nfunction crearQuery(archivo){\r\n  len = contenidoArchivoExcelFacturas.length;\r\n  query = \"\"\r\n  for (i=0; i<len; i++){\r\n    \r\n      query =  query + \"EXEC [REG21].[INGRESAR_REGISTRO_EXCEL_FACTURAS] @AC='\"+contenidoArchivoExcelFacturas[i].AC+\"', @numeroCesion='\"+contenidoArchivoExcelFacturas[i].numeroCesion+\"',@facturaSRI='\"+contenidoArchivoExcelFacturas[i].facturaSRI+\"',@fechaFactura='\"+contenidoArchivoExcelFacturas[i].fechaFactura+\"',@cliente='\"+contenidoArchivoExcelFacturas[i].cliente+\"',@textoBreveMaterial='\"+contenidoArchivoExcelFacturas[i].textoBreveMaterial+\"',@cdtaFacturada='\"+contenidoArchivoExcelFacturas[i].cdtaFacturada+\"',@notaCreditoDevolucion='\"+contenidoArchivoExcelFacturas[i].notaCreditoDevolucion+\"',@fechaNotaCredito='\"+contenidoArchivoExcelFacturas[i].fechaNotaCredito+\"',@codigoInscrLkBco='\"+contenidoArchivoExcelFacturas[i].codigoInscrLkBco+\"',@partidaArancelaria='\"+contenidoArchivoExcelFacturas[i].partidaArancelaria+\"',@descripcionItem='\"+contenidoArchivoExcelFacturas[i].descripcionItem+\"',@tipoUnidad='\"+contenidoArchivoExcelFacturas[i].tipoUnidad+\"',@maxCnLiBco='\"+contenidoArchivoExcelFacturas[i].maxCnLiBco+\"',@maxCdLiBco='\"+contenidoArchivoExcelFacturas[i].maxCdLiBco+\"',@idArchivoExcel=\"+idArchivoExcel+\"; \";\r\n  }\r\n  return query;\r\n}"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":45,"y":2208},"next":{"exit":{"activity_category":17,"activity":{"cell_id":"ab744373-52f2-4f78-b9c2-d036c085b5c0","code":2,"params":{"version":"4.35.0","database_type":null,"setup_method":"basicParameters","connection_string":{"use_previous_step":false},"host":null,"port":null,"database":null,"user":"","password":"","query_text":{"use_previous_step":false,"statement":"query"},"comment":null,"breakpoint":false,"deactivated":false,"login":null,"encrypt":false}},"position":{"x":81,"y":2375},"next":{"error":{"activity_category":1,"activity":{"cell_id":"d05255a6-b662-4ede-8994-321d6e5438d4","code":14,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"value":"","use_previous_step":false},"log_message":{"use_previous_step":true},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":51,"y":2450},"next":{}},"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","error"]}}}}}}}}}}}}}}}}}}},"error":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","yes","next","exit","next","exit","next","exit"]}}}}}}},"no":{"activity_category":1,"activity":{"cell_id":"bed2f1cf-1750-4330-9e96-a9b314ed3039","code":14,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"value":"","use_previous_step":false},"log_message":{"value":"Sin facturas","use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":520,"y":1053.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"8318bb67-dd29-4de6-a551-4897686e526b","code":3,"params":{"version":"4.35.0","variable_name":"globalBoolEjecucionCorrecta","variable_value":{"use_previous_step":false,"statement":"true"},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":576,"y":1128.6},"next":{}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},{"start":{"activity_category":1,"activity":{"cell_id":"192866c5-2a9c-412a-8b56-726ebf124d20","code":3,"params":{"version":"4.35.0","variable_name":"contadorRegistrosArchivoExcel","variable_value":{"use_previous_step":false,"statement":"contadorRegistrosArchivoExcel+1"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":3,"y":2595.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"25cb5967-e8a5-4761-925c-79db993b0a36","code":1,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"contadorRegistrosArchivoExcel<cantidadRegistrosArchivoExcel","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":476,"y":2478.6},"next":{"yes":{"activity_category":17,"activity":{"cell_id":"da4be0e0-136b-40cb-adba-e3270fe83138","code":2,"params":{"version":"4.35.0","database_type":null,"setup_method":"basicParameters","connection_string":{"use_previous_step":false},"host":null,"port":null,"database":null,"user":"","password":"","query_text":{"use_previous_step":false,"statement":"`EXEC [REG21].[INGRESAR_REGISTRO_EXCEL_FACTURAS] \r\n@AC='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].AC}',\r\n@numeroCesion='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].numeroCesion}',\r\n@facturaSRI='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].facturaSRI}',\r\n@fechaFactura='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].fechaFactura}',\r\n@cliente='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].cliente}',\r\n@textoBreveMaterial='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].textoBreveMaterial}',\r\n@cdtaFacturada='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].cdtaFacturada}',\r\n@notaCreditoDevolucion='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].notaCreditoDevolucion}',\r\n@fechaNotaCredito='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].fechaNotaCredito}',\r\n@codigoInscrLkBco='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].codigoInscrLkBco}',\r\n@partidaArancelaria='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].partidaArancelaria}',\r\n@descripcionItem='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].descripcionItem}',\r\n@tipoUnidad='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].tipoUnidad}',\r\n@maxCnLiBco='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].maxCnLiBco}',\r\n@maxCdLiBco='${contenidoArchivoExcelFacturas[contadorRegistrosArchivoExcel].maxCdLiBco}',\r\n@idArchivoExcel=${idArchivoExcel}`"},"comment":null,"breakpoint":false,"deactivated":false,"login":null,"encrypt":false}},"position":{"x":403,"y":2637.6},"next":{"error":{"activity_category":1,"activity":{"cell_id":"6acfb1ee-e0d8-4c0f-9657-b13101a1733f","code":14,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"value":"","use_previous_step":false},"log_message":{"use_previous_step":true},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":425,"y":2763.6},"next":{}}}},"no":{"activity_category":1,"activity":{"cell_id":"ef916137-0f0e-42ac-b9d4-85dd5845dd9d","code":14,"params":{"version":"4.35.0","variable_name":null,"variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"value":"","use_previous_step":false},"log_message":{"value":"Registros ingresados","use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":744,"y":2592.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"1f216ff5-2d1d-4b21-88b4-87859e761582","code":3,"params":{"version":"4.35.0","variable_name":"contadorArchivosFactura","variable_value":{"use_previous_step":false,"statement":"contadorArchivosFactura+1"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":966,"y":2555.6},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"3b65fd51-8646-4240-8df6-00aa644a5b05","code":3,"params":{"version":"4.35.0","variable_name":"fechaActualNombreArchivo","variable_value":{"use_previous_step":false,"statement":"function(){\r\n    const currentDate = new Date();\r\nconst day = currentDate.getDate().toString().padStart(2, '0');\r\nconst month = (currentDate.getMonth() + 1).toString().padStart(2, '0');\r\nconst year = currentDate.getFullYear().toString();\r\nconst hours = currentDate.getHours().toString().padStart(2, '0');\r\nconst minutes = currentDate.getMinutes().toString().padStart(2, '0');\r\nconst seconds = currentDate.getSeconds().toString().padStart(2, '0');\r\n\r\nconst formattedDate = `${day}_${month}_${year}_${hours}_${minutes}_${seconds}_`;\r\nreturn formattedDate;\r\n}();"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":1106,"y":2378.6},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"eb8c4fb8-e1eb-4795-a955-ddbca84c593a","code":7,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"configRutaInsumosCompartidos+archivoFacturas"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"configRutaRaizResultados+'RESPALDOS\\\\'+fechaActualNombreArchivo+archivoFacturas"},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":true}},"position":{"x":988,"y":2280.6},"next":{"exit":{"activity_category":17,"activity":{"cell_id":"cf6032f9-3910-4ae1-9efd-75ddded1e94b","code":2,"params":{"version":"4.35.0","database_type":null,"setup_method":"basicParameters","connection_string":{"use_previous_step":false},"host":null,"port":null,"database":null,"user":"","password":"","query_text":{"use_previous_step":false,"statement":"`EXEC [REG21].[MODIFICAR_ARCHIVO_FACTURAS] @idArchivoExcel=${idArchivoExcel},@rutaExcel='${configRutaRaizResultados+'RESPALDOS\\\\'+fechaActualNombreArchivo+archivoFacturas}'`"},"comment":null,"breakpoint":false,"deactivated":false,"login":null,"encrypt":false}},"position":{"x":1032,"y":2162.6},"next":{"exit":{"$type":"ref","value":["start-0","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit","next","exit"]}}}}}}}}}}}}}}}},{"start":{"activity_category":1,"activity":{"cell_id":"0abbc2df-d10f-455c-9ed0-adfd342fa1b7","code":3,"params":{"version":"4.35.0","variable_name":"contadorRegistrosArchivoExcel","variable_value":{"use_previous_step":false,"statement":"0"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":390,"y":2267},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0eafa7f4-c4b3-4b04-a285-ddcd1a8a2a9b","code":3,"params":{"version":"4.35.0","variable_name":"cantidadRegistrosArchivoExcel","variable_value":{"use_previous_step":false,"statement":"contenidoArchivoExcelFacturas.length"},"is_variable_global":false,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":388,"y":2338.6},"next":{"exit":{"$type":"ref","value":["start-1","next","exit"]}}}}}},{"start":{"activity_category":1,"activity":{"cell_id":"973baada-6058-4ff4-aadc-042e2081d12e","code":3,"params":{"version":"4.35.0","variable_name":"mensajeError","variable_value":{"value":"No se pudo ingresar los datos a la base dedatos","use_previous_step":false},"is_variable_global":true,"condition":null,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"subroutine_path":null,"comment":null,"command":{"use_previous_step":false},"breakpoint":false,"deactivated":false,"background":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","app_title":null,"launch_params":null,"password":null,"iterator_id":null,"iterator_source":{"use_previous_step":false},"fields_map":null,"js_file_path":null,"username":null,"timeout":0}},"position":{"x":632,"y":2708.6},"next":{"exit":{"$type":"ref","value":["start-1","next","exit","next","yes","next","error"]}}}},{"start":{"activity_category":2,"activity":{"cell_id":"cff8bfdb-a58a-4be9-8856-9fb873249854","code":3,"params":{"version":"4.35.0","path":{"value":"C:\\Users\\Jorge Noguera\\Desktop\\test.txt","use_previous_step":false},"content":{"use_previous_step":false,"statement":"contenidoArchivoExcelFacturas"},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false},"comment":null,"breakpoint":false,"deactivated":false,"source_type":"folder","text_file_type":"plainText","is_subfolders":false,"is_full_path":false,"is_replace_existing":false}},"position":{"x":-3,"y":2103},"next":{}}},{"start":{"activity_category":17,"activity":{"cell_id":"c489c1a6-4bbe-4e4c-8829-bfe5f80f298c","code":2,"params":{"version":"4.35.0","database_type":null,"setup_method":"basicParameters","connection_string":{"use_previous_step":false},"host":null,"port":null,"database":null,"user":"","password":"","query_text":{"use_previous_step":false,"statement":"\"EXEC [REG21].[INGRESAR_REGISTRO_EXCEL_FACTURAS] @AC='', @numeroCesion='13213',@facturaSRI='9039213083123',@fechaFactura='2023-02-16T00:00:00',@cliente='asdfdfdfsdf',@textoBreveMaterial='safdasdasdasd',@cdtaFacturada='76',@notaCreditoDevolucion='',@fechaNotaCredito='',@codigoInscrLkBco='sadasdasdsa',@partidaArancelaria='1108120000',@descripcionItem='asdasdasdas',@tipoUnidad='KG',@maxCnLiBco='1.2483',@maxCdLiBco='0.0562',@idArchivoExcel=34; EXEC [REG21].[INGRESAR_REGISTRO_EXCEL_FACTURAS] @AC='', @numeroCesion='13213',@facturaSRI='9039213083123',@fechaFactura='2023-02-17T00:00:00',@cliente='asdfdfdfsdf',@textoBreveMaterial='safdasdasdasd',@cdtaFacturada='77',@notaCreditoDevolucion='',@fechaNotaCredito='',@codigoInscrLkBco='sadasdasdsa',@partidaArancelaria='1108120001',@descripcionItem='asdasdasdas',@tipoUnidad='KG',@maxCnLiBco='1.2483',@maxCdLiBco='0.0562',@idArchivoExcel=34; EXEC [REG21].[INGRESAR_REGISTRO_EXCEL_FACTURAS] @AC='', @numeroCesion='13213',@facturaSRI='9039213083123',@fechaFactura='2023-02-18T00:00:00',@cliente='asdfdfdfsdf',@textoBreveMaterial='safdasdasdasd',@cdtaFacturada='78',@notaCreditoDevolucion='',@fechaNotaCredito='',@codigoInscrLkBco='sadasdasdsa',@partidaArancelaria='1108120002',@descripcionItem='asdasdasdas',@tipoUnidad='KG',@maxCnLiBco='1.2483',@maxCdLiBco='0.0562',@idArchivoExcel=34;\""},"comment":null,"breakpoint":false,"deactivated":false,"login":null,"encrypt":false}},"position":{"x":-84,"y":2329},"next":{}}}]