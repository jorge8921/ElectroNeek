[{"start":{"activity_category":1,"activity":{"cell_id":"3dddb71e-8d35-4e12-8525-070e445af3d0","code":8,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"script_id":"bbef91bb-9fbe-4016-8500-e3a9daa54f62","password":null,"iterator_source":{"use_previous_step":false},"studio_version":{"created":"8.5.8","updated":"8.5.8"},"paper_size":{"height":2000,"width":2000,"x":-216,"y":-16},"username":null,"link_vertices":{"0":{"source_id":"c5161e1a-5800-4d1d-818f-8970d1263c0e","source_port":"exit","target_id":"0d10a139-2fd6-4d31-bc57-c20c40448ac4","vertices":[{"x":122,"y":1410},{"x":-156,"y":1347}]},"1":{"source_id":"c5161e1a-5800-4d1d-818f-8970d1263c0e","source_port":"exit","target_id":"0d10a139-2fd6-4d31-bc57-c20c40448ac4","vertices":[{"x":122,"y":1410},{"x":-156,"y":1347}]}}}},"position":{"x":541,"y":34},"next":{"exit":{"activity_category":7,"activity":{"cell_id":"45af9972-e164-4f8d-a7ec-17ad9b9504e8","code":2,"params":{"version":"4.35.0","to":{"use_previous_step":false},"cc":{"use_previous_step":false},"subject":{"use_previous_step":false},"body":{"use_previous_step":false},"date_from":{"use_previous_step":false,"statement":"moment().subtract(10, 'days')"},"attachment_path":{"use_previous_step":false},"attachment_save_template":{"value":"Tmp","use_previous_step":false},"attachment_save":true,"attachment_save_duplicate":false,"server_host":{"use_previous_step":false},"server_secure":true,"server_type":"gmail","breakpoint":false,"box_name":{"value":"Preply","use_previous_step":false},"login":{"host":"GoogleMail","login":"j.noguera@electroneek.com"},"subject_contains":{"value":"","use_previous_step":false},"body_contains":{"value":"","use_previous_step":false},"sender":{"value":"","use_previous_step":false},"attachment_filter":"all","mark_as_read":true,"emails_limit":{"value":"","use_previous_step":false},"move_folder":{"use_previous_step":false}}},"position":{"x":511,"y":134},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"8537bd90-461e-4a90-83fe-71e7ed695148","code":3,"params":{"version":"8.5.8","variable_name":"email_messages","variable_value":{"use_previous_step":true},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":429,"y":215},"next":{}}}}}}},{"start":{"activity_category":1,"activity":{"cell_id":"41ee3199-bc9e-4fb0-807f-d34c2ca32a1f","code":3,"params":{"version":"4.35.0","variable_name":"dir","variable_value":{"use_previous_step":false,"statement":"\"C:\\\\tmp\\\\\""},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":486,"y":305},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"9da1e153-db01-452a-a807-b07a5239206d","code":3,"params":{"version":"4.35.0","variable_name":"asunto","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":504,"y":381},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"6b41ba71-ebbc-4428-81e7-25a69f8c4585","code":3,"params":{"version":"8.5.8","variable_name":"i","variable_value":{"value":0,"use_previous_step":false},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":506.70000000000005,"y":465.20000000000005},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0d10a139-2fd6-4d31-bc57-c20c40448ac4","code":1,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"condition":"i<email_messages.length","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":320.2,"y":550.8000000000001},"next":{"yes":{"activity_category":1,"activity":{"cell_id":"3c24386a-a9c5-4759-b6bd-00efb19bc712","code":1,"params":{"version":"4.35.0","variable_value":{"value":"","use_previous_step":false},"is_variable_global":false,"condition":"email_messages[i].hasAttachment == true","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"value":0.25,"use_previous_step":false},"command":{"use_previous_step":false},"breakpoint":false,"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"log_severity":"info","password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":126,"y":672},"next":{"yes":{"activity_category":2,"activity":{"cell_id":"a1e38cae-d0ae-47c6-af83-ab5c6dbfa155","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"dir"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"formatDate(email_messages[i].date);\r\nfunction formatDate(fecha){\r\n    fecha = moment(fecha).format(\"DD-MM-YYYY\");\r\n    fecha = fecha.trim();\r\n    return fecha;\r\n}"},"breakpoint":false,"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":50,"y":801},"next":{"exit":{"activity_category":2,"activity":{"cell_id":"5300eb9c-a0f8-4ed5-b930-c151d7c11b46","code":11,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"formatDate(email_messages[i].date);\r\nfunction formatDate(fecha){\r\n    fecha = moment(fecha).format(\"DD-MM-YYYY\");\r\n    dir = dir+fecha;\r\n    dir = dir.trim();\r\n    return dir;\r\n}"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"formatSubject(email_messages[i].subject);\r\nfunction formatSubject(ast){\r\n    asunto = ast.replace(/[^a-zA-Z0-9_ -]/g,'');\r\n    \r\n    if(asunto.length>50){\r\n        asunto = asunto.slice(0,50);\r\n    }\r\n    asunto = asunto.replace(/^[.\\s]+|[.\\s]+$/g, \"\");\r\n    return asunto;\r\n}"},"breakpoint":false,"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":44,"y":877},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"e235a45b-6fc3-4110-a1f6-20fda2bf9c8e","code":3,"params":{"version":"8.5.8","variable_name":"j","variable_value":{"use_previous_step":false,"statement":"0"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":60,"y":952},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"0beececa-45bb-4959-b5cb-9e462f2834e2","code":1,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"condition":"j<email_messages[i].attachments.length","basicCondition":null,"conditionType":"advanced","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":-51,"y":1042},"next":{"yes":{"activity_category":2,"activity":{"cell_id":"884dc58b-63ad-4231-bce4-733e716c6f13","code":7,"params":{"version":"4.35.0","path":{"use_previous_step":false,"statement":"email_messages[i].attachments[j].path"},"content":{"use_previous_step":false},"copy_from":{"use_previous_step":false},"move_to":{"use_previous_step":false,"statement":"extractFileName(email_messages[i].attachments[j].path);\r\n\r\nfunction extractFileName(ruta){\r\n    var ruta = ruta.split('Tmp\\\\');\r\n    ruta = dir+\"\\\\\"+asunto+\"\\\\\"+ruta[1];\r\n    ruta = ruta.trim();\r\n    return ruta;\r\n}"},"breakpoint":false,"source_type":"folder","text_file_type":"plainText","is_replace_existing":true}},"position":{"x":-69,"y":1151},"next":{"exit":{"activity_category":1,"activity":{"cell_id":"f2763c40-0fd4-4232-bc3b-2685dd84a3d0","code":3,"params":{"version":"8.5.8","variable_name":"j","variable_value":{"use_previous_step":false,"statement":"j=j+1"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":-86,"y":1219},"next":{"exit":{"$type":"ref","value":["start-1","next","exit","next","exit","next","exit","next","yes","next","yes","next","exit","next","exit","next","exit"]}}},"error":{"$type":"ref","value":["start-1","next","exit","next","exit","next","exit","next","yes","next","yes","next","exit","next","exit","next","exit","next","yes","next","exit"]}}},"no":{"activity_category":1,"activity":{"cell_id":"c5161e1a-5800-4d1d-818f-8970d1263c0e","code":3,"params":{"version":"8.5.8","variable_name":"asig","variable_value":{"use_previous_step":false,"statement":"updateVariables();\r\nfunction updateVariables(){\r\n    i = i+1;\r\n    dir = \"C:\\\\tmp\\\\\";\r\n    asunto = \"\";    \r\n}"},"is_variable_global":false,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":156,"y":1279},"next":{"exit":{"$type":"ref","value":["start-1","next","exit","next","exit","next","exit"]}}}}}}}}}}},"no":{"$type":"ref","value":["start-1","next","exit","next","exit","next","exit","next","yes","next","yes","next","exit","next","exit","next","exit","next","no"]}}},"no":{"activity_category":1,"activity":{"cell_id":"84516f30-80f2-439e-8e42-d2efcabcee6f","code":0,"params":{"version":"8.5.8","variable_value":{"use_previous_step":false},"is_variable_global":true,"basicCondition":null,"conditionType":"basic","delay_ms":0,"delay_sec":{"use_previous_step":false},"comment":"Place actions to be performed after the loop","command":{"use_previous_step":false},"log_details":{"use_previous_step":false},"log_message":{"use_previous_step":false},"password":null,"iterator_source":{"use_previous_step":false},"username":null}},"position":{"x":464.29999999999995,"y":649.2},"next":{}}}}}}}}}}}]